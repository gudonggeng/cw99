<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">

    <!-- å¾®ä¿¡æœç´¢å…¬ä¼—å·ã€ ç¨‹åºå‘˜é±¼çš® ã€ï¼Œå­¦ä¹ ç¼–ç¨‹æŠ€æœ¯ï¼Œå‘ç°æ›´å¤šå¥½ç©çš„é¡¹ç›®ï¼ -->
    <title>åˆæˆå¤§è¥¿ç“œ</title>

    <!--http://www.html5rocks.com/en/mobile/mobifying/-->
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1, minimum-scale=1,maximum-scale=1" />

    <!--https://developer.apple.com/library/safari/documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html-->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no">

    <!-- force webkit on 360 -->
    <meta name="renderer" content="webkit" />
    <meta name="force-rendering" content="webkit" />
    <!-- force edge on IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="msapplication-tap-highlight" content="no">

    <!-- force full screen on some browser -->
    <meta name="full-screen" content="yes" />
    <meta name="x5-fullscreen" content="true" />
    <meta name="360-fullscreen" content="true" />

    <!-- force screen orientation on some browser -->
    <meta name="screen-orientation" content="" />
    <meta name="x5-orientation" content="">

    <!--fix fireball/issues/3568 -->
    <!--<meta name="browsermode" content="application">-->
    <meta name="x5-page-mode" content="app">

    <!--<link rel="apple-touch-icon" href=".png" />-->
    <!--<link rel="apple-touch-icon-precomposed" href=".png" />-->


    <!-- <script>
        pushHistory();
        window.addEventListener("popstate", function(e) {

        }, false);
        function pushHistory() {
            var state = {
                title: "",
                url: window.location.href
            };
            window.history.pushState(state, state.title, state.url);
        }
    </script> -->
<!--    <script type="text/javascript">
        var ua = navigator.userAgent.toLowerCase(); //è·å–åˆ¤æ–­ç”¨çš„å¯¹è±¡
        //åˆ¤æ–­æ˜¯å¦æ˜¯å¾®ä¿¡ä¸‹è®¿é—®
        if (ua.match(/MicroMessenger/i) == "micromessenger") {1
            // if (/(iPhone|iPad|iPod|iOS)/i.test(navigator.userAgent)) {
            location.href = "https://mp.weixin.qq.com/s/m0U0L-vnD0Gu8aPJ2vcPoA";
            // }
        }
    </script>-->

    <link rel="stylesheet" type="text/css" href="style-mobile.css" />

</head>

<body style="margin: 0; background: #ddd;" align="center">
    <div style="align:center;display: none"><img src="res/share.jpg" width="10%" /></div>

    <!-- âœ… æ–°å¢ï¼šèƒŒæ™¯éŸ³ä¹ï¼ˆéšè—ï¼‰ -->
    <audio id="bgm" preload="auto" loop style="display:none">
        <source src="audio/bgm.mp3" type="audio/mpeg">
    </audio>

    <!-- âœ… æ–°å¢ï¼šå¤±è´¥éŸ³æ•ˆï¼ˆéšè—ï¼Œsrc åœ¨ JS é‡ŒåŠ¨æ€åˆ‡æ¢ï¼‰ -->
    <audio id="loseSfx" preload="auto" style="display:none"></audio>

    <!-- âœ… æ–°å¢ï¼šç§»åŠ¨ç«¯å¼ºåˆ¶â€œç”¨æˆ·æ‰‹åŠ¿â€å¼€å¯éŸ³é¢‘ï¼ˆä¸å½±å“ç”µè„‘ç«¯ï¼Œç”µè„‘ç‚¹ä¸€ä¸‹ä¹Ÿä¼šè‡ªåŠ¨æ¶ˆå¤±ï¼‰ -->
    <div id="bgmOverlay"
         style="position:fixed;left:0;top:0;width:100%;height:100%;
                z-index:99999;display:flex;align-items:center;justify-content:center;
                background:rgba(0,0,0,0.35);">
      <div style="background:rgba(255,255,255,0.95);
                  padding:14px 18px;border-radius:12px;
                  font-size:16px;line-height:1.4;text-align:center;">
        <div style="margin-bottom:10px;">
            <span style="color:blue;">ğŸ€</span>
            å¤§å®å¤©å¤©è§
            <span style="color:pink;">ğŸ€</span>
        </div>
        <button id="bgmBtn"
                style="font-size:16px;padding:10px 16px;border-radius:10px;border:0;">
          å‡ºå‘å­~
        </button>
        <div style="margin-top:10px;font-size:12px;opacity:0.7;">
          ccweiå‡ºå“
        </div>
      </div>
    </div>

    <!-- âœ… æ–°å¢ï¼šBGM å–‡å­å¼€å…³æŒ‰é’®ï¼ˆå·²å¾€å·¦æŒªï¼Œé¿å…é®æŒ¡å³ä¸Šè§’ 216*216 çš„é‡è¦å›¾ç‰‡ï¼‰
         ä½ è¯´å³ä¸Šè§’æœ‰ä¸ª 216*216 ä¸èƒ½é®æŒ¡ï¼Œæ‰€ä»¥è¿™é‡Œä¸ç”¨ right:12pxï¼Œè€Œæ˜¯ right:240pxï¼ˆå¯å†è°ƒï¼‰
    -->
    <div id="bgmSpeaker"
         style="position:fixed;top:12px;right:240px;z-index:99998;
                width:44px;height:44px;border-radius:22px;
                background:transparent;
                display:flex;align-items:center;justify-content:center;
                box-shadow:none;
                user-select:none;-webkit-user-select:none;">

        <button id="bgmToggleBtn"
                style="width:44px;height:44px;border:0;background:transparent;
                       font-size:22px;line-height:44px;cursor:pointer;">
            ğŸ”Š
        </button>
    </div>

    <div id="canvasDiv" style="width:100%;height:100%;">
        <canvas id="GameCanvas" oncontextmenu="event.preventDefault()" tabindex="0"></canvas>

        <video id="contentElement" style="display:none;position: absolute;top:0px;left: 0px;">
                <source src="http://rmcdn.2mdn.net/Demo/vast_inspector/android.mp4"></source>
                <source src="http://rmcdn.2mdn.net/Demo/vast_inspector/android.webm"></source>
      </video>
        <div id="block-Box" style="display:block;width:100%;height:100%;"></div>
    </div>



    <div id="adContainer" style="display:none;position: absolute;top:0px;left: 0px;width:100%;height:100%;z-index:999;"></div>
    <div id="loadingText" style="width:100%;display: none;text-align:center;position:absolute;top:45%;z-index:2;font-size:20px;color:#f99f0a">
        loading......0%
    </div>

    <div id="splash">
        <!-- <div class="progress-bar stripes"> -->
        <!-- <span style="width: 0%"></span> -->
        <!-- </div> -->
    </div>

    <div id="loadingImg" style="top:45%;width: 100%;position:absolute; ">
        <img src="res/loading.gif" width="7%" height="7%" />
    </div>


    <script type="text/javascript" src="//imasdk.googleapis.com/js/sdkloader/ima3.js"></script>
    <script type="text/javascript" src="ads.js"></script>

    <script src="src/settings.js" charset="utf-8"></script>

    <script type="text/javascript">
        var preloader;
        var adCompleteFlag = false;
        var resCompleteFlag = false;

        var adEndComplete = false;
        var resEndComplete = false;

        judgeLanTitle();

        function judgeLanTitle() {

            //        console.log("window.navigator.language",window.navigator.language);

            if (window.navigator.language == "zh-CN" || window.navigator.language == "zh-cn") {
                document.title = "å°æ¸¸æˆï¼šåˆæˆå¤§è¥¿ç“œ";
            } else if (window.navigator.language == "zh-TW") {
                document.title = "å°éŠæˆ²ï¼šåˆæˆå¤§è¥¿ç“œ";
            } else if (window.navigator.language == "zh-HK") {
                document.title = "å°éŠæˆ²ï¼šåˆæˆå¤§è¥¿ç“œ";
            } else if (window.navigator.language == "ko-KR") {
                document.title = "ì‘ì€ ë†€ì´ï¼ší° ìˆ˜ë°• ì„ í•©ì„± í•˜ ë‹¤";
            } else if (window.navigator.language == "ja-JP") {
                document.title = "ãƒŸãƒ‹ã‚²ãƒ¼ãƒ ï¼šåˆæˆã‚¹ã‚¤ã‚«";
            } else if (window.navigator.language == "th-TH") {
                document.title = "à¹€à¸à¸¡à¹€à¸¥à¹‡à¸à¹†ï¼šà¹à¸•à¸‡à¹‚à¸¡à¸ªà¸±à¸‡à¹€à¸„à¸£à¸²à¸°à¸«à¹Œ";
            } else {
                document.title = "Little gameï¼šSynthetic watermelon";
            }


        }

        var loadintT = document.getElementById("loadingText");
        var loadintGif = document.getElementById("loadingImg")
        setTimeout(function() {
            loadintGif.remove();
            loadintT.style.display = ""
            updateLabView(0.1);
        }, 1 * 1000)

        window.timer = null;
        window.tempSeconds = 1;
        window.loadData = {};
        loadData.completedCount = 0;
        loadData.totalCount = 0;

        onload();

        function onload() {
            var winHeight = document.documentElement.clientHeight;
            document.getElementById("canvasDiv").style.height = winHeight + "px";
        };
        window.onload = function() {
            document.getElementById("block-Box").style.display = "none";
        }

        function updateLabView(t) {
            if (timer != null) {
                clearInterval(timer);
            }
            timer = setInterval(function() {
                tempSeconds++;
                actualTotal();
                var loadintT = document.getElementById("loadingText")
                if (!loadintT) {
                    return;
                }
                loadintT.innerHTML = 'loading......' + parseInt(tempSeconds) + '%';

                switch (tempSeconds) {
                    case 20:
                        updateLabView(0.2);
                        break;
                    case 40:
                        updateLabView(0.3);
                        break;
                    case 60:
                        updateLabView(0.4);
                        break;
                    case 96:
                        updateLabView(5);
                        break;
                    case 97:
                        updateLabView(10);
                        break;
                    case 98:
                        updateLabView(50);
                        break;
                    case 99:
                        updateLabView(100);
                        break;
                    default:
                        if (tempSeconds >= 80 && tempSeconds < 96) {
                            updateLabView(t + 0.1);
                        }
                        break;
                }
                if (tempSeconds > 100) {
                    clearInterval(timer);
                    tempSeconds = 100
                    loadintT.innerHTML = 'loading......' + parseInt(tempSeconds) + '%';
                }
            }, t * 1000);
        }

        function actualTotal() {
            var percent = parseInt(100 * loadData.completedCount / loadData.totalCount);
            if (percent > tempSeconds && loadData.totalCount > 1) {
                tempSeconds = percent;
            }
        }


        /*setTimeout("ShowBannerAD()","2000");*/
    </script>

    <!-- âœ… æ–°å¢ï¼šèƒŒæ™¯éŸ³ä¹å¯åŠ¨é€»è¾‘ï¼ˆæ›´ç¨³ï¼‰
         è¯´æ˜ï¼š
         1) å¾®ä¿¡é‡Œ/æ‰‹æœºæµè§ˆå™¨æ™®éç¦æ­¢â€œæ— æ‰‹åŠ¿è‡ªåŠ¨æ’­æ”¾å¸¦å£°éŸ³éŸ³é¢‘â€
         2) æ‰€ä»¥ç”¨é®ç½©æŒ‰é’®å¼ºåˆ¶ç”¨æˆ·ç‚¹ä¸€æ¬¡è§£é”éŸ³é¢‘
         3) iOS/å¾®ä¿¡æ›´ç¨³çš„åšæ³•ï¼šå…ˆé™éŸ³ play()ï¼ŒæˆåŠŸåå†å–æ¶ˆé™éŸ³
    -->
    <script type="text/javascript">
        (function () {
            var bgm = document.getElementById('bgm');
            var overlay = document.getElementById('bgmOverlay');
            var btn = document.getElementById('bgmBtn');
            var started = false;

            // âœ… æ–°å¢ï¼šå–‡å­æŒ‰é’®ï¼ˆå¼€å…³éŸ³é‡ï¼‰
            var speakerBtn = document.getElementById('bgmToggleBtn');
            var speakerWrap = document.getElementById('bgmSpeaker');

            // âœ… æ–°å¢ï¼šè®°ä½ç”¨æˆ·æ˜¯å¦é™éŸ³ï¼ˆåˆ·æ–°/é‡è¿›é¡µé¢ä¹Ÿä¿æŒï¼‰
            function getMuted() {
                try {
                    return localStorage.getItem('BGM_MUTED') === '1';
                } catch (e) {
                    return false;
                }
            }
            function setMuted(v) {
                try {
                    localStorage.setItem('BGM_MUTED', v ? '1' : '0');
                } catch (e) {}
            }
            function syncSpeakerUI() {
                if (!speakerBtn) return;
                var muted = bgm ? !!bgm.muted : getMuted();
                speakerBtn.textContent = muted ? 'ğŸ”‡' : 'ğŸ”Š';
            }

            function startBgm() {
                if (!bgm) return;

                // ä¸€äº›ç§»åŠ¨ç«¯å†…æ ¸éœ€è¦
                bgm.setAttribute('playsinline', '');
                bgm.setAttribute('webkit-playsinline', '');
                bgm.setAttribute('x5-playsinline', '');
                bgm.loop = true;
                bgm.preload = 'auto';
                bgm.volume = 0.8;

                // iOS/å¾®ä¿¡æ›´ç¨³ï¼šå…ˆé™éŸ³å¯åŠ¨ï¼Œå†è§£é™¤é™éŸ³ï¼ˆå¦‚æœç”¨æˆ·ä¸æ˜¯â€œæ‰‹åŠ¨é™éŸ³â€çŠ¶æ€ï¼‰
                var userMuted = getMuted();
                bgm.muted = true;

                var p = bgm.play();
                if (p && typeof p.then === 'function') {
                    p.then(function () {
                        started = true;

                        // å¦‚æœç”¨æˆ·è®¾ç½®äº†é™éŸ³ï¼Œå°±ä¿æŒé™éŸ³ï¼›å¦åˆ™è§£é™¤é™éŸ³
                        setTimeout(function () {
                            bgm.muted = userMuted ? true : false;
                            syncSpeakerUI();
                        }, 50);

                        if (overlay) overlay.style.display = 'none';
                    }).catch(function () {
                        // ä»è¢«æ‹¦æˆªå°±ä¸éšè—é®ç½©ï¼Œè®©ç”¨æˆ·å†ç‚¹ä¸€æ¬¡
                    });
                } else {
                    started = true;

                    setTimeout(function () {
                        bgm.muted = userMuted ? true : false;
                        syncSpeakerUI();
                    }, 50);

                    if (overlay) overlay.style.display = 'none';
                }
            }

            // âœ… æŒ‰é’®ç‚¹å‡»ï¼ˆæœ€ç¨³ï¼‰
            if (btn) {
                btn.addEventListener('click', function (e) {
                    e.preventDefault();
                    e.stopPropagation();
                    startBgm();
                }, { capture: true });
            }

            // âœ… æ–°å¢ï¼šå–‡å­æŒ‰é’®ç‚¹å‡»ï¼ˆå¼€å…³é™éŸ³ï¼‰
            if (speakerBtn) {
                speakerBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    e.stopPropagation();

                    // å¦‚æœè¿˜æ²¡å¼€å§‹æ’­æ”¾ï¼Œå…ˆå°è¯•å¯åŠ¨ï¼ˆå¦åˆ™ç§»åŠ¨ç«¯å¯èƒ½æ— æ•ˆï¼‰
                    if (!started) {
                        startBgm();
                    }

                    // åˆ‡æ¢é™éŸ³
                    var nowMuted = bgm ? !bgm.muted : !getMuted();
                    if (bgm) bgm.muted = nowMuted;
                    setMuted(nowMuted);
                    syncSpeakerUI();
                }, { capture: true });
            }

            // åˆå§‹åŒ–å–‡å­ UIï¼ˆæ ¹æ®å†å²é™éŸ³çŠ¶æ€ï¼‰
            syncSpeakerUI();

            // âœ… å…¼å®¹ï¼šç”¨æˆ·ç¬¬ä¸€æ¬¡è§¦æ‘¸/ç‚¹å‡»é¡µé¢ä¹Ÿå°è¯•ï¼ˆæœ‰æ—¶èƒ½ç›´æ¥æˆåŠŸï¼‰
            function tryOnce() {
                if (started) return;
                startBgm();
            }
            document.addEventListener('touchstart', tryOnce, { once: true, passive: true });
            document.addEventListener('mousedown', tryOnce, { once: true });
            document.addEventListener('keydown', tryOnce, { once: true });

            // å¾®ä¿¡ç¯å¢ƒå¸¸ç”¨ï¼šWeixinJSBridgeReady
            document.addEventListener('WeixinJSBridgeReady', tryOnce, false);

            // åˆ‡å›é¡µé¢æ—¶ï¼Œå¦‚æœå·²ç»è§£é”è¿‡ä½†æš‚åœäº†ï¼Œå°è¯•æ¢å¤ï¼ˆç”µè„‘ç«¯å¸¸è§ï¼‰
            document.addEventListener('visibilitychange', function () {
                if (!document.hidden && bgm && started && bgm.paused) {
                    try { bgm.play(); } catch (e) {}
                }
            });
            window.addEventListener('focus', function () {
                if (bgm && started && bgm.paused) {
                    try { bgm.play(); } catch (e) {}
                }
            });
        })();
    </script>

    <!-- âœ… æ–°å¢ï¼šæ‹¦æˆªå¹¿å‘Š/å¤–é“¾è·³è½¬ï¼Œæ”¹ä¸ºå¼¹ä¸€å¥è¯ï¼ˆä¿ç•™åŸå¹¿å‘Šé€»è¾‘ï¼ŒåæœŸæƒ³æ¢å¤å¹¿å‘Šï¼šåˆ æ‰è¿™æ®µå³å¯ï¼‰
         è¯´æ˜ï¼š
         1) ä½ å·²ç»æŠŠ ads.js é‡Œ adLink='' äº†ï¼Œä½†ä»ç„¶è·³ï¼Œè¯´æ˜è¿˜æœ‰å…¶å®ƒä½ç½®åœ¨ openURL / window.open / location è·³è½¬
         2) æ‰€ä»¥è¿™é‡Œç»Ÿä¸€æ‹¦æˆªâ€œè·³å¤–é“¾â€çš„è¡Œä¸º
         3) è¢«æ‹¦æˆªåä¸è·³è½¬ï¼Œåªæç¤ºï¼šå¥½å¥½åƒé¥­ï¼Œå¥½å¥½ç”Ÿæ´»ï¼
    -->
    <script type="text/javascript">
        (function () {
            var TIP_TEXT = 'å¥½å¥½åƒé¥­ï¼Œå¥½å¥½ç”Ÿæ´»ï¼';

            function showTip(msg) {
                var id = '__ad_tip__';
                var el = document.getElementById(id);
                if (!el) {
                    el = document.createElement('div');
                    el.id = id;
                    el.style.cssText =
                        'position:fixed;left:50%;top:18%;transform:translateX(-50%);' +
                        'z-index:1000000;background:rgba(0,0,0,0.75);color:#fff;' +
                        'padding:10px 14px;border-radius:10px;font-size:16px;' +
                        'max-width:86%;text-align:center;line-height:1.4;';
                    document.body.appendChild(el);
                }
                el.textContent = msg || TIP_TEXT;
                el.style.display = 'block';
                clearTimeout(el.__t);
                el.__t = setTimeout(function () {
                    el.style.display = 'none';
                }, 1600);
            }

            // æ˜¯å¦éœ€è¦æ‹¦æˆªï¼šåªè¦æ˜¯ http(s) ä¸”ä¸æ˜¯æœ¬ç«™åŒåŸŸï¼Œå°±æ‹¦æˆª
            function shouldBlock(url) {
                if (!url) return false;
                try {
                    url = String(url);
                } catch (e) {
                    return false;
                }
                // ç©ºå­—ç¬¦ä¸²ã€javascript: ä¹‹ç±»ä¸å¤„ç†
                if (!/^https?:\/\//i.test(url)) return false;

                try {
                    var u = new URL(url, window.location.href);
                    // ä¸æ˜¯åŒåŸŸåï¼ˆorigin ä¸åŒï¼‰ => è§†ä¸ºå¤–é“¾/å¹¿å‘Š => æ‹¦æˆª
                    if (u.origin !== window.location.origin) return true;
                } catch (e) {
                    // URL è§£æå¤±è´¥ä¹Ÿå½“ä½œå¤–é“¾æ‹¦æˆª
                    return true;
                }
                return false;
            }

            // 1) æ‹¦æˆª window.open
            var _open = window.open;
            window.open = function (url) {
                if (shouldBlock(url)) {
                    showTip(TIP_TEXT);
                    return null;
                }
                return _open.apply(window, arguments);
            };

            // 2) æ‹¦æˆª location.assign / replace
            try {
                var _assign = window.location.assign.bind(window.location);
                window.location.assign = function (url) {
                    if (shouldBlock(url)) {
                        showTip(TIP_TEXT);
                        return;
                    }
                    return _assign(url);
                };
            } catch (e) {}
            try {
                var _replace = window.location.replace.bind(window.location);
                window.location.replace = function (url) {
                    if (shouldBlock(url)) {
                        showTip(TIP_TEXT);
                        return;
                    }
                    return _replace(url);
                };
            } catch (e) {}

            // 3) æ‹¦æˆª Cocos çš„ cc.sys.openURLï¼ˆcc åŠ è½½åæ‰æœ‰ï¼Œæ‰€ä»¥è½®è¯¢ç­‰å¾…ï¼‰
            var timer = setInterval(function () {
                try {
                    if (window.cc && cc.sys && typeof cc.sys.openURL === 'function') {
                        var _openURL = cc.sys.openURL.bind(cc.sys);
                        cc.sys.openURL = function (url) {
                            if (shouldBlock(url)) {
                                showTip(TIP_TEXT);
                                return false;
                            }
                            return _openURL(url);
                        };
                        clearInterval(timer);
                    }
                } catch (e) {}
            }, 200);

            // 4) å…œåº•ï¼šæ•è·ç‚¹å‡» a æ ‡ç­¾å¤–é“¾ï¼ˆæœ‰äº›å¹¿å‘Šç›´æ¥æ˜¯ <a href="http...">ï¼‰
            document.addEventListener('click', function (e) {
                try {
                    var t = e.target;
                    while (t && t !== document.body) {
                        if (t.tagName && t.tagName.toLowerCase() === 'a') {
                            var href = t.getAttribute('href') || '';
                            if (shouldBlock(href)) {
                                e.preventDefault();
                                e.stopPropagation();
                                showTip(TIP_TEXT);
                                return false;
                            }
                            break;
                        }
                        t = t.parentNode;
                    }
                } catch (err) {}
            }, true);
        })();
    </script>




    <script src="src/settings.js" charset="utf-8"></script>
    <script src="src/extraSettings.js" charset="utf-8"></script>

    <script src="main.js" charset="utf-8"></script>

    <script type="text/javascript">
    /**
     * âœ… å¤±è´¥éŸ³æ•ˆï¼ˆæŒ‚åˆ°çœŸæ­£çš„ GameOver / gameEndï¼‰
     * ç›®æ ‡ï¼šç¢°çº¿ï¼ˆGameOverï¼‰ç¬é—´éšæœºæ’­æ”¾ lose1/2/3.mp3ï¼›å…¶ä»–æ—¶å€™ç»ä¸æ’­æ”¾
     * ä»…ä¿®æ”¹ index.htmlï¼Œä¸æ”¹ main.js / project.js
     */
    (function () {
      var loseEl = document.getElementById('loseSfx');
      var LOSE_LIST = ['audio/lose1.mp3', 'audio/lose2.mp3', 'audio/lose3.mp3'];

      // æœ¬å±€åªæ’­ä¸€æ¬¡ï¼Œé¿å…åŒä¸€å¸§/åŒä¸€é€»è¾‘å¤šæ¬¡è§¦å‘
      var playedThisGameOver = false;

      // âœ… è®©éšæœºæ›´åƒéšæœºï¼šé¿å…è¿ç»­ä¸¤æ¬¡æŠ½åˆ°åŒä¸€æ¡
      var lastIdx = -1;

      function pickLose() {
        var idx = (Math.random() * LOSE_LIST.length) | 0;
        if (LOSE_LIST.length > 1 && idx === lastIdx) {
          idx = (idx + 1 + ((Math.random() * (LOSE_LIST.length - 1)) | 0)) % LOSE_LIST.length;
        }
        lastIdx = idx;
        return LOSE_LIST[idx];
      }

      function playLoseOnceNow() {
        if (playedThisGameOver) return;
        playedThisGameOver = true;

        if (!loseEl) {
          console.warn('[LOSE_SFX] loseSfx element not found');
          return;
        }

        try { loseEl.pause(); } catch (e) {}

        try {
          loseEl.loop = false;
          loseEl.preload = 'auto';
          loseEl.volume = 1.0;
          loseEl.muted = false;

          var src = pickLose();
          loseEl.src = src;
          loseEl.currentTime = 0;

          var p = loseEl.play();
          if (p && typeof p.catch === 'function') {
            p.catch(function (err) {
              console.warn('[LOSE_SFX] play blocked:', err);
            });
          }
          // è°ƒè¯•ç”¨ï¼šä½ å¯ä»¥çœ‹åˆ°åˆ°åº•éšæœºåˆ°äº†å“ªä¸€æ¡
          console.log('[LOSE_SFX] play ->', src);
        } catch (e) {
          console.warn('[LOSE_SFX] play error:', e);
        }
      }

      function resetLoseFlag() {
        playedThisGameOver = false;
      }

      // ç»™ä½  Console æ‰‹åŠ¨æµ‹è¯•
      window.__PLAY_LOSE_SFX__ = playLoseOnceNow;
      window.__RESET_LOSE_SFX__ = resetLoseFlag;

      function wrap(obj, key, before) {
        if (!obj) return false;
        var fn = obj[key];
        if (typeof fn !== 'function') return false;
        if (fn.__LOSE_WRAPPED__) return true;

        var wrapped = function () {
          try { before && before.call(this); } catch (e) {}
          return fn.apply(this, arguments);
        };
        wrapped.__LOSE_WRAPPED__ = true;
        obj[key] = wrapped;
        return true;
      }

      // âœ… å…³é”®ï¼šç›´æ¥ hook ä½ å †æ ˆé‡Œæ˜¾ç¤ºçš„ window.__require.GameManager.t.GameOver
      function patchGameManagerModule() {
        var R = window.__require;
        if (!R) return false;

        // 1) ä½ æ—¥å¿—é‡Œæ˜ç¡®å­˜åœ¨è¿™ä¸ªè·¯å¾„
        var gmMod = R.GameManager;
        if (gmMod) {
          // gmMod.t å¯èƒ½æ˜¯ class / constructor
          var t = gmMod.t || gmMod.default || gmMod;

          var ok = false;

          if (t) {
            // åŒæ—¶å…¼å®¹ï¼šé™æ€æŒ‚è½½ / prototype æŒ‚è½½
            if (typeof t.GameOver === 'function') {
              ok = wrap(t, 'GameOver', function () {
                if (!document.hidden) playLoseOnceNow();
              }) || ok;
            }
            if (t.prototype && typeof t.prototype.GameOver === 'function') {
              ok = wrap(t.prototype, 'GameOver', function () {
                if (!document.hidden) playLoseOnceNow();
              }) || ok;
            }

            // æœ‰äº›ç‰ˆæœ¬å« gameEndï¼ˆå°å†™ï¼‰
            if (typeof t.gameEnd === 'function') {
              ok = wrap(t, 'gameEnd', function () {
                if (!document.hidden) playLoseOnceNow();
              }) || ok;
            }
            if (t.prototype && typeof t.prototype.gameEnd === 'function') {
              ok = wrap(t.prototype, 'gameEnd', function () {
                if (!document.hidden) playLoseOnceNow();
              }) || ok;
            }

            // é‡å¼€æ—¶é‡ç½®
            if (typeof t.RestartGame === 'function') {
              ok = wrap(t, 'RestartGame', function () { resetLoseFlag(); }) || ok;
            }
            if (t.prototype && typeof t.prototype.RestartGame === 'function') {
              ok = wrap(t.prototype, 'RestartGame', function () { resetLoseFlag(); }) || ok;
            }
          }

          if (ok) return true;
        }

        // 2) å…œåº•ï¼šæ‰«æåœºæ™¯ç»„ä»¶ï¼ˆæŸäº›åŒ…ä¸ä¼šæš´éœ² R.GameManagerï¼‰
        try {
          if (window.cc && cc.director && cc.director.getScene) {
            var scene = cc.director.getScene();
            if (scene && scene.getComponentsInChildren) {
              var comps = scene.getComponentsInChildren(cc.Component);
              for (var i = 0; i < comps.length; i++) {
                var c = comps[i];
                if (!c) continue;

                if (typeof c.GameOver === 'function') {
                  wrap(c, 'GameOver', function () {
                    if (!document.hidden) playLoseOnceNow();
                  });
                }
                if (typeof c.gameEnd === 'function') {
                  wrap(c, 'gameEnd', function () {
                    if (!document.hidden) playLoseOnceNow();
                  });
                }
                if (typeof c.RestartGame === 'function') {
                  wrap(c, 'RestartGame', function () { resetLoseFlag(); });
                }
              }
              return true;
            }
          }
        } catch (e) {}

        return false;
      }

      // åœºæ™¯åˆ‡æ¢åä¹Ÿ patch ä¸€æ¬¡ï¼ˆCreator å¸¸è§ï¼‰
      function installSceneHook() {
        if (!window.cc || !cc.director || !cc.Director) return;
        if (installSceneHook.__done) return;
        installSceneHook.__done = true;

        try {
          cc.director.on(cc.Director.EVENT_AFTER_SCENE_LAUNCH, function () {
            resetLoseFlag();
            setTimeout(patchGameManagerModule, 0);
            setTimeout(patchGameManagerModule, 200);
            setTimeout(patchGameManagerModule, 800);
          });
        } catch (e) {}
      }

      // è½®è¯¢ç­‰å¾… __require / cc å°±ç»ª
      var timer = setInterval(function () {
        installSceneHook();
        var ok = patchGameManagerModule();
        if (ok) {
          // ç¨³ä¸€ç‚¹ï¼šç­‰å‡ ç§’å†åœè½®è¯¢ï¼Œé˜²æ­¢æ™šåŠ è½½è¦†ç›–
          setTimeout(function () { try { clearInterval(timer); } catch (e) {} }, 3000);
        }
      }, 200);
    })();
    </script>



    <script>
        window.adsbygoogle = window.adsbygoogle || [];
        const adBreak = function(o) {
            adsbygoogle.push(o);
        }
    </script>


    <script type="text/javascript">
        (function() {
            // open web debugger console
            if (typeof VConsole !== 'undefined') {
                window.vConsole = window.vConsole || new VConsole();
            }

            var splash = document.getElementById('splash');
            splash.style.display = 'block';


            console.log("indexlTextTTTT");

            var cocos2d = document.createElement('script');
            cocos2d.async = true;
            cocos2d.src = window._CCSettings.debug ? 'cocos2d-js.js' : 'cocos2d-js-min.js';

            var engineLoaded = function() {
                document.body.removeChild(cocos2d);
                cocos2d.removeEventListener('load', engineLoaded, false);
                window.boot();
            };
            cocos2d.addEventListener('load', engineLoaded, false);
            document.body.appendChild(cocos2d);
        })();
    </script>




</body>

</html>


